apiVesrion: v1
kind: ConfigMap
metadata:
  name: {{ include "open-ondemand.fullname" }}-autofs
data:
  autofs_config.sh: |
    #!/bin/bash
    cat >> /etc/auto.ondemand <<EOF
    {{- range .Values.advanced.fileSharing.autofs_mounts }}
    {{ . }}
    {{- end }}
    EOF
    export path={{ .Values.advanced.fileSharing.autofs_path }}
    mkdir -p $path
    cat >> /etc/auto.master.d/ondemand.autofs <<EOF
    $path  /etc/auto.ondemand
    EOF