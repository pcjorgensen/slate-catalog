apiVersion: v1
kind: ConfigMap
metadata:
  name: autofs
data:
  autofs_config.sh: |
    #!/bin/bash
    cat >> /etc/auto.ondemand <<EOF
    {{- range .Values.advanced.fileSharing.autofs_mounts }}
    {{ . }}
    {{- end }}
    EOF
    export autofs_path={{ .Values.advanced.fileSharing.autofs_path }}
    mkdir -p $autofs_path
    cat >> /etc/auto.master.d/ondemand.autofs <<EOF
    $autofs_path  /etc/auto.ondemand
    EOF